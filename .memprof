#!/usr/bin/env ruby
# frozen_string_literal: true

puts %x(free -h)
puts

require 'jekyll'
require 'memory_profiler'

Dir.chdir(File.expand_path("docs", __dir__)) do
  report = MemoryProfiler.report do
    Jekyll::Commands::Build.process(
      "source"      => File.expand_path("."),
      "destination" => File.expand_path("./_site"),
    )
  end

  puts "\nGenerating results..\n\n"

  puts %x(free -h)
  puts

  report.pretty_print(scale_bytes: true, normalize_paths: true, color_output: false)
end
